# Portable Executables
* the binary file format that Microsoft Windows uses for executables (EXE), dynamic link libraries (DLL) and others.
* derived from COFF (Common Object File Format) used by most Unix executables.
* 
## Portable Executable File Format
* Overview \
![image](https://user-images.githubusercontent.com/88809233/167351089-681613fe-7733-451d-a606-d3638270fecc.png)
* Detailed \
![image2](https://raw.githubusercontent.com/corkami/pics/master/binary/PE101.png)
* Extensions that use the PE Format

|Extensions|Description| |Extensions|Description|
|----------|-----------|-|----------|-----------|
|.exe|Executable| |.efi|Extensible Firmware Interface file (bootloader executables)|
|.dll|Dynamic-link Library| |.mui|Multilingual User Interface file - contains resources that allow changing the Windows Interface to display different languages|
|.acm|Audio Compression Manager| |.ocx|ActiveX Form|
|.ax|MPEG-4 DVD Filter| |.scr|Screensaver|
|.cpl|Control Panel| |.sys|Device Driver (Kernel)|
|.drv|Driver file(Kernel)| |.tsp|Windows Telephony Service Provider File|

## Shared Libraries
* Executables nowadays depend on other executables or libraries.
* A library is a collection of code that can be used by multiple programs at the same time.
* In Microsoft Executables, the library will use the `.dll` file extension but will have headers that are similar to `.exe` files.

## Static vs Dynamic Linking
* Linker is responsible for adding the libraries into the final executable.
* There are 2 types of linkers : 
   1. With static linking, the linker will resolve all library requirements and copy the library into the final executable, thus producing an executable with the library embedded inside.
   2. Dynamic Linking is sub divided into two more types : 
      * Implicit Linking
         * Linker links the referenced library into the program but the functions referenced do not get added to the executable and are only loaded at execution time.
         * At execution time, OS loads the library for the executable and manages all the memory addresses for the program. 
         * Implicitly linked executables will have a section in the PE structure (.rdata), which holds all the libraries being imported and the functions referenced.
      
      * Explicit Linking
         * Explicit linking does not require an import section nor the linker to link the library to the program.
         * It is done at the source code side and the OS does not need to load the library on runtime.
         * Example is `LoadLibrary()` function and `GetProcAddress()`
### Performance Comparison
|Comparison|Static|Dynamic|
|----------|------|-------|
|Referencing|Faster|Slower|
|Executable Size|Bigger|Smaller|
|maintenance|more difficult|easier|
|Memory Usage|Higher|Lower|

# PE File Header Analysis
* Main Headers for Analysis : 
   1. MS-DOS Header
      
   2. Signature (Image Only)
   
   3. COFF File Header
   
   4. Optional Header



